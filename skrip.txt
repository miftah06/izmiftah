import telebot
import openai

bot = telebot.TeleBot("6822789783:AAFtP72J5vP9mSIQanfPZtJasRlRoLBd3nY")
openai.api_key = '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'

@bot.message_handler(commands=['start', 'help'])
def send_welcome(message):
    bot.reply_to(message, "Halo, selamat datang di bot saya. Kirim pesan dengan format: /write Judul;Subjudul1,Subjudul2;Kata kunci1,Kata kunci2")

@bot.message_handler(commands=['write'])
def write_document(message):
    inputs = message.text[len('/write '):].split(';')
    if len(inputs) != 3:
        bot.reply_to(message, "Format salah, silakan ikuti format ini: /write Judul;Subjudul1,Subjudul2;Kata kunci1,Kata kunci2")
        return

    judul = inputs[0].strip()
    subjudul_list = inputs[1].strip().split(',')
    keywords_list = inputs[2].strip().split(',')

    # membuat prompt 
    prompt = f"Judul: {judul}\n\n"

    for idx, sub_judul in enumerate(subjudul_list, start=1):
        prompt += f"Sub_{idx}: {sub_judul}\n"
    prompt += "Keywords: " + ', '.join(keywords_list) + "\n\n"
    
    response = openai.Completion.create(
    model="gpt-3.5-turbo-instruct",
    prompt="Hello, world!",
    max_tokens=10
    )

    bot.reply_to(message, response.choices[0].text.strip())

bot.polling()
